$(".js-endorsement-form .loader").addClass('hide');
<% if @success %>
$("#endorsements_<%=@endorsement.user_tag_id%>_list").prepend('<%=escape_javascript(render :partial => 'endorsements/endorsement', :locals => {:endorsement => @endorsement}) %>');
$('.js-endorsement-form #endorsement_description').val('');
$('.js-endorsement-form #endorsement_user_tag_id').val('');
$('.js-endorsement-form #user_tag_id').val('');
$(".js-endorsement-form").hide();
if($("#endorsements_<%=@endorsement.user_tag_id%>_list").children().length == 1){
  $("#endorse_<%=@endorsement.user_tag_id%>_container .js-endorsements-toggle").removeClass('hide').click();
} else {
  if ($("#endorsements_<%=@endorsement.user_tag_id%>_list").hasClass('hide')){
    $("#endorse_<%=@endorsement.user_tag_id%>_container .js-endorsements-toggle").text("Hide all endorsements");
    $("#endorsements_<%=@endorsement.user_tag_id%>_list").removeClass('hide').slideDown(800);
  } else{
    $("#endorse_<%=@endorsement.user_tag_id%>_container .js-endorsements-toggle").text("Show all endorsements");
    $("#endorsements_<%=@endorsement.user_tag_id%>_list").addClass('hide').slideUp(800);
  }
}
<% else %>
$(".js-endorsement-form").replaceWith('<%=escape_javascript(render :partial => 'endorsements/form')%>');
<% end %>